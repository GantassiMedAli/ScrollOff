<app-user-navbar></app-user-navbar>

<section class="challenges-hero py-5 text-center text-white mt-5">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-md-8">
        <h1 class="display-4 fw-bold mb-3">Digital Detox Challenges</h1>
        <p class="lead">Take on concrete challenges designed to help you build healthier digital habits</p>
      </div>
    </div>
  </div>
</section>

<section class="challenges-content py-5">
  <div class="container">
    <div *ngIf="loading" class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>

    <div *ngIf="error" class="alert alert-warning" role="alert">
      {{ error }}
    </div>

    <div *ngIf="!loading && !error && challenges.length === 0" class="text-center py-5">
      <p class="text-muted">No challenges available at the moment. Check back soon!</p>
    </div>

    <div *ngIf="!loading && !error && challenges.length > 0" class="row g-4">
      <div class="col-md-6 col-lg-4" *ngFor="let challenge of challenges; let i = index">
        <div class="challenge-card challenge-gradient-card fade-in" [style.animation-delay]="(i * 0.1) + 's'" (click)="openChallengeDetail(challenge)">
          <div class="d-flex justify-content-between align-items-start mb-3">
            <span class="level-badge" [ngClass]="getLevelClass(challenge.niveau)">
              {{ getLevelLabel(challenge.niveau) }}
            </span>
            <span class="duration-badge">
              <i class="fas fa-clock me-1"></i>
              {{ challenge.duree }} days
            </span>
          </div>
          <h5 class="fw-bold mb-3">{{ challenge.titre }}</h5>
          <p class="text-muted mb-3">{{ challenge.description }}</p>
          <button class="challenge-btn btn-sm w-100">
            View Details
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Challenge Detail Modal -->
<div class="modal-overlay" *ngIf="showModal" (click)="closeModal()">
  <div class="modal-content" (click)="$event.stopPropagation()" *ngIf="selectedChallenge">
    <div class="modal-header">
      <h3 class="modal-title">{{ selectedChallenge.titre }}</h3>
      <button type="button" class="btn-close" (click)="closeModal()" aria-label="Close"></button>
    </div>
    <div class="modal-body">
      <div class="mb-4">
        <div class="d-flex gap-3 mb-3">
          <span class="level-badge" [ngClass]="getLevelClass(selectedChallenge.niveau)">
            {{ getLevelLabel(selectedChallenge.niveau) }} Level
          </span>
          <span class="duration-badge">
            <i class="fas fa-clock me-1"></i>
            {{ selectedChallenge.duree }} days
          </span>
        </div>
        <p class="lead">{{ selectedChallenge.description }}</p>
      </div>
      <div class="challenge-info">
        <h6 class="fw-bold mb-3">What to expect:</h6>
        <ul class="list-unstyled">
          <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Daily progress tracking</li>
          <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Community support</li>
          <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Tips and resources</li>
          <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Rewards upon completion</li>
        </ul>
      </div>
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-secondary" (click)="closeModal()">Close</button>
      <button type="button" class="btn btn-primary challenge-join-btn" (click)="joinChallenge()">
        <i class="fas fa-plus me-2"></i>
        Join Challenge
      </button>
    </div>
  </div>
</div>

<app-user-footer></app-user-footer>
