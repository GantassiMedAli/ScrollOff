<app-user-navbar></app-user-navbar>

<!-- Hero Header Section -->
<section class="challenges-hero-header">
  <div class="hero-container">
    <h1 class="hero-title">Transform Your Digital Habits</h1>
    <p class="hero-subtitle">Join thousands taking on challenges to reduce screen time and reclaim their lives</p>
    
    <div class="hero-stats">
      <div class="stat-item">
        <div class="stat-value">52K+</div>
        <div class="stat-label">Active Participants</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">23</div>
        <div class="stat-label">Live Challenges</div>
      </div>
      <div class="stat-item">
        <div class="stat-value">87%</div>
        <div class="stat-label">Success Rate</div>
      </div>
    </div>
  </div>
</section>

<!-- Filter Bar -->
<section class="filter-bar">
  <div class="filter-container">
    <div class="filter-tabs">
      <button 
        class="filter-tab" 
        [class.active]="activeFilter === 'all'"
        (click)="setFilter('all')">
        All Challenges
      </button>
      <button 
        class="filter-tab" 
        [class.active]="activeFilter === 'beginner'"
        (click)="setFilter('beginner')">
        Beginner
      </button>
      <button 
        class="filter-tab" 
        [class.active]="activeFilter === 'intermediate'"
        (click)="setFilter('intermediate')">
        Intermediate
      </button>
      <button 
        class="filter-tab" 
        [class.active]="activeFilter === 'advanced'"
        (click)="setFilter('advanced')">
        Advanced
      </button>
    </div>
    <div class="search-box">
      <i class="bi bi-search"></i>
      <input 
        type="text" 
        placeholder="Search challenges..." 
        [(ngModel)]="searchQuery"
        class="search-input">
    </div>
  </div>
</section>

<!-- Main Content -->
<section class="challenges-main-content">
  <div class="content-container">
    
    <div *ngIf="loading" class="loading-state">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>

    <div *ngIf="error" class="error-state">
      <div class="alert alert-warning" role="alert">
        {{ error }}
      </div>
    </div>

    <div *ngIf="!loading && !error">
      
      <!-- Featured Challenge -->
      <div class="section-header" *ngIf="featuredChallenge">
        <h2 class="section-title">Featured Challenge</h2>
      </div>
      
      <div class="featured-challenge-card" *ngIf="featuredChallenge" (click)="viewChallenge(featuredChallenge)">
        <div class="featured-image">
          <div class="featured-badge">
            <i class="bi bi-star-fill"></i>
            MOST POPULAR
          </div>
        </div>
        <div class="featured-content">
          <h3 class="featured-title">{{ featuredChallenge.titre }}</h3>
          <p class="featured-description">{{ featuredChallenge.description }}</p>
          <ul class="featured-benefits" *ngIf="featuredChallenge.benefits">
            <li *ngFor="let benefit of featuredChallenge.benefits">
              <i class="bi bi-check-circle-fill"></i>
              {{ benefit }}
            </li>
          </ul>
          <button class="btn-featured-join">
            <i class="bi bi-person-plus me-2"></i>
            Join Challenge
          </button>
        </div>
      </div>

      <!-- Beginner Challenges -->
      <div class="section-header" *ngIf="beginnerChallenges.length > 0">
        <h2 class="section-title">Beginner Challenges</h2>
        <a href="#" class="view-all-link">View All <i class="bi bi-arrow-right"></i></a>
      </div>
      
      <div class="challenges-grid" *ngIf="beginnerChallenges.length > 0">
        <div 
          class="challenge-card" 
          *ngFor="let challenge of beginnerChallenges.slice(0, 3)"
          (click)="viewChallenge(challenge)">
          <div class="challenge-icon">
            <i class="bi bi-phone"></i>
          </div>
          <span class="challenge-badge" [ngClass]="getDifficultyBadgeClass(challenge)">
            {{ getDifficultyLabel(challenge) }}
          </span>
          <h4 class="challenge-card-title">{{ challenge.titre }}</h4>
          <p class="challenge-card-description">{{ challenge.description }}</p>
          <div class="challenge-stats">
            <div class="stat-row">
              <span class="stat-label">Success Rate</span>
              <span class="stat-value">{{ challenge.successRate }}%</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Avg. Time Saved</span>
              <span class="stat-value">{{ challenge.avgTimeSaved || '2.5hrs' }}</span>
            </div>
          </div>
          <div class="progress-bar-wrapper">
            <div class="progress-bar" [style.width.%]="getProgressPercentage(challenge)"></div>
          </div>
          <button class="btn-challenge-start">
            <i class="bi bi-play-fill me-2"></i>
            Start Challenge
          </button>
        </div>
      </div>

      <!-- Intermediate Challenges -->
      <div class="section-header" *ngIf="intermediateChallenges.length > 0">
        <h2 class="section-title">Intermediate Challenges</h2>
        <a href="#" class="view-all-link">View All <i class="bi bi-arrow-right"></i></a>
      </div>
      
      <div class="challenges-grid" *ngIf="intermediateChallenges.length > 0">
        <div 
          class="challenge-card" 
          *ngFor="let challenge of intermediateChallenges.slice(0, 3)"
          (click)="viewChallenge(challenge)">
          <div class="challenge-icon">
            <i class="bi bi-square"></i>
          </div>
          <span class="challenge-badge" [ngClass]="getDifficultyBadgeClass(challenge)">
            {{ getDifficultyLabel(challenge) }}
          </span>
          <h4 class="challenge-card-title">{{ challenge.titre }}</h4>
          <p class="challenge-card-description">{{ challenge.description }}</p>
          <div class="challenge-stats">
            <div class="stat-row">
              <span class="stat-label">Success Rate</span>
              <span class="stat-value">{{ challenge.successRate }}%</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Avg. Time Saved</span>
              <span class="stat-value">{{ challenge.avgTimeSaved || '3.8hrs' }}</span>
            </div>
          </div>
          <div class="progress-bar-wrapper">
            <div class="progress-bar" [style.width.%]="getProgressPercentage(challenge)"></div>
          </div>
          <button class="btn-challenge-start">
            <i class="bi bi-play-fill me-2"></i>
            Start Challenge
          </button>
        </div>
      </div>

      <!-- Advanced Challenges -->
      <div class="section-header" *ngIf="advancedChallenges.length > 0">
        <h2 class="section-title">Advanced Challenges</h2>
        <a href="#" class="view-all-link">View All <i class="bi bi-arrow-right"></i></a>
      </div>
      
      <div class="challenges-grid" *ngIf="advancedChallenges.length > 0">
        <div 
          class="challenge-card" 
          *ngFor="let challenge of advancedChallenges.slice(0, 3)"
          (click)="viewChallenge(challenge)">
          <div class="challenge-icon">
            <i class="bi bi-lightning-charge"></i>
          </div>
          <span class="challenge-badge" [ngClass]="getDifficultyBadgeClass(challenge)">
            {{ getDifficultyLabel(challenge) }}
          </span>
          <h4 class="challenge-card-title">{{ challenge.titre }}</h4>
          <p class="challenge-card-description">{{ challenge.description }}</p>
          <div class="challenge-stats">
            <div class="stat-row">
              <span class="stat-label">Success Rate</span>
              <span class="stat-value">{{ challenge.successRate }}%</span>
            </div>
            <div class="stat-row">
              <span class="stat-label">Avg. Time Saved</span>
              <span class="stat-value">{{ challenge.avgTimeSaved || '5.2hrs' }}</span>
            </div>
          </div>
          <div class="progress-bar-wrapper">
            <div class="progress-bar" [style.width.%]="getProgressPercentage(challenge)"></div>
          </div>
          <button class="btn-challenge-start">
            <i class="bi bi-play-fill me-2"></i>
            Start Challenge
          </button>
        </div>
      </div>

    </div>

  </div>
</section>

<app-user-footer></app-user-footer>
